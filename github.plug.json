{
  "name": "github",
  "imports": [
    "https://get.silverbullet.md/global.plug.json"
  ],
  "functions": {
    "queryEvents": {
      "events": [
        "query:gh-event"
      ],
      "code": "(() => { var mod=(()=>{var C=Object.create;var p=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty;var R=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var P=(e,t)=>{for(var r in t)p(e,r,{get:t[r],enumerable:!0})},h=(e,t,r,o)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let n of M(t))!S.call(e,n)&&n!==r&&p(e,n,{get:()=>t[n],enumerable:!(o=E(t,n))||o.enumerable});return e};var $=(e,t,r)=>(r=e!=null?C(N(e)):{},h(t||!e||!e.__esModule?p(r,\"default\",{value:e,enumerable:!0}):r,e)),O=e=>h(p({},\"__esModule\",{value:!0}),e);var Z={};P(Z,{default:()=>X});function d(e,t){if(t(e))return[e];let r=[];if(e.children)for(let o of e.children)r=[...r,...d(o,t)];return r}function x(e,t){return d(e,r=>r.type===t)[0]}function v(e,t){d(e,t)}function w(e,t){let r=[];if(e.filter.length===0)r=t.slice();else{e:for(let o of t){let n=o;for(let{op:i,prop:a,value:l}of e.filter)switch(i){case\"=\":{let c=n[a];if(Array.isArray(c)&&!Array.isArray(l)){if(!c.includes(l))continue e}else if(Array.isArray(c)&&Array.isArray(l)){if(!c.some(f=>l.includes(f)))continue e}else if(c!=l)continue e;break}case\"!=\":if(n[a]==l)continue e;break;case\"<\":if(!(n[a]<l))continue e;break;case\"<=\":if(!(n[a]<=l))continue e;break;case\">\":if(!(n[a]>l))continue e;break;case\">=\":if(!(n[a]>=l))continue e;break;case\"=~\":if(!new RegExp(l).exec(n[a]))continue e;break;case\"!=~\":if(new RegExp(l).exec(n[a]))continue e;break;case\"in\":if(!l.includes(n[a]))continue e;break}r.push(n)}}return e.orderBy&&(r=r.sort((o,n)=>{let i=e.orderBy,a=e.orderDesc;return o[i]===n[i]?0:o[i]<n[i]?a?1:-1:a?-1:1})),e.limit&&(r=r.slice(0,e.limit)),e.select&&(r=r.map(o=>{let n={};for(let i of e.select)n[i]=o[i];return n})),r}typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var s=self.syscall;var m={};P(m,{parseMarkdown:()=>I});function I(e){return s(\"markdown.parseMarkdown\",e)}var g={};P(g,{deleteAttachment:()=>H,deletePage:()=>D,getAttachmentMeta:()=>K,getPageMeta:()=>q,listAttachments:()=>V,listPages:()=>j,listPlugs:()=>_,readAttachment:()=>z,readPage:()=>Q,writeAttachment:()=>G,writePage:()=>U});function j(e=!1){return s(\"space.listPages\",e)}function q(e){return s(\"space.getPageMeta\",e)}function Q(e){return s(\"space.readPage\",e)}function U(e,t){return s(\"space.writePage\",e,t)}function D(e){return s(\"space.deletePage\",e)}function _(){return s(\"space.listPlugs\")}function V(){return s(\"space.listAttachments\")}function K(e){return s(\"space.getAttachmentMeta\",e)}function z(e){return s(\"space.readAttachment\",e)}function G(e,t,r){return s(\"space.writeAttachment\",e,t,r)}function H(e){return s(\"space.deleteAttachment\",e)}var y=$(R(\"https://deno.land/std/encoding/yaml.ts\"));async function b(e,t=[\"yaml\"]){let r=await g.readPage(e),o=await m.parseMarkdown(r),n={};return v(o,i=>{if(i.type!==\"FencedCode\")return!1;let a=x(i,\"CodeInfo\");if(!a||!t.includes(a.children[0].text))return!1;let l=x(i,\"CodeText\");if(!l)return!1;let c=l.children[0].text;try{n=y.parse(c)}catch(f){throw console.error(\"YAML Page parser error\",f),new Error(`YAML Error: ${f.message}`)}return!0}),n}async function T(e){try{let t=await b(\"SECRETS\",[\"yaml\",\"secrets\"]),r=[];for(let o of e){let n=t[o];if(n)r.push(n);else throw new Error(`No such secret: ${o}`)}return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e[0]}`):t}}async function W(){try{let[e]=await T([\"githubToken\"]);return e}catch{console.error(\"No github-config page found, using default config\");return}}var u=class{constructor(t){this.token=t}async apiCall(t,r={}){let o=await fetch(t,{...r,headers:{Authorization:this.token?`token ${this.token}`:void 0}});if(o.status!==200)throw new Error(await o.text());return o.json()}listEvents(t){return this.apiCall(`https://api.github.com/users/${t}/events?per_page=100`)}listPulls(t,r=\"all\",o=\"updated\"){return this.apiCall(`https://api.github.com/repos/${t}/pulls?state=${r}&sort=${o}&direction=desc&per_page=100`)}searchIssues(t,r=\"\"){return t=encodeURIComponent(t),this.apiCall(`https://api.github.com/search/issues?q=${t}&sort=${r}&direction=desc&per_page=100`)}listNotifications(){return this.apiCall(\"https://api.github.com/notifications?per_page=100\")}static async fromConfig(){return new u(await W())}};async function k({query:e}){let t=await u.fromConfig(),r=e.filter.find(i=>i.prop===\"username\");if(!r)throw Error(\"No 'username' filter specified, this is mandatory\");let o=[];if(r.op===\"=\")o=[r.value];else if(r.op===\"in\")o=r.value;else throw new Error(`Unsupported operator ${r.op}`);let n=[];for(let i of await Promise.all(o.map(a=>t.listEvents(a))))n.push(...i);return e.filter.splice(e.filter.indexOf(r),1),w(e,n.map(i=>A(i)))}function A(e,t=\"\"){let r={};for(let[o,n]of Object.entries(e))t&&(o=t+\"_\"+o),n&&typeof n==\"object\"?r={...r,...A(n,o)}:r[o]=n;return r}var X=k;return O(Z);})();\n return mod;})()"
    },
    "queryPulls": {
      "events": [
        "query:gh-pull"
      ],
      "code": "(() => { var mod=(()=>{var C=Object.create;var p=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty;var R=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var P=(e,t)=>{for(var r in t)p(e,r,{get:t[r],enumerable:!0})},h=(e,t,r,o)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let n of M(t))!S.call(e,n)&&n!==r&&p(e,n,{get:()=>t[n],enumerable:!(o=E(t,n))||o.enumerable});return e};var $=(e,t,r)=>(r=e!=null?C(N(e)):{},h(t||!e||!e.__esModule?p(r,\"default\",{value:e,enumerable:!0}):r,e)),O=e=>h(p({},\"__esModule\",{value:!0}),e);var Z={};P(Z,{default:()=>X});function d(e,t){if(t(e))return[e];let r=[];if(e.children)for(let o of e.children)r=[...r,...d(o,t)];return r}function x(e,t){return d(e,r=>r.type===t)[0]}function v(e,t){d(e,t)}function w(e,t){let r=[];if(e.filter.length===0)r=t.slice();else{e:for(let o of t){let n=o;for(let{op:i,prop:a,value:l}of e.filter)switch(i){case\"=\":{let c=n[a];if(Array.isArray(c)&&!Array.isArray(l)){if(!c.includes(l))continue e}else if(Array.isArray(c)&&Array.isArray(l)){if(!c.some(f=>l.includes(f)))continue e}else if(c!=l)continue e;break}case\"!=\":if(n[a]==l)continue e;break;case\"<\":if(!(n[a]<l))continue e;break;case\"<=\":if(!(n[a]<=l))continue e;break;case\">\":if(!(n[a]>l))continue e;break;case\">=\":if(!(n[a]>=l))continue e;break;case\"=~\":if(!new RegExp(l).exec(n[a]))continue e;break;case\"!=~\":if(new RegExp(l).exec(n[a]))continue e;break;case\"in\":if(!l.includes(n[a]))continue e;break}r.push(n)}}return e.orderBy&&(r=r.sort((o,n)=>{let i=e.orderBy,a=e.orderDesc;return o[i]===n[i]?0:o[i]<n[i]?a?1:-1:a?-1:1})),e.limit&&(r=r.slice(0,e.limit)),e.select&&(r=r.map(o=>{let n={};for(let i of e.select)n[i]=o[i];return n})),r}typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var s=self.syscall;var m={};P(m,{parseMarkdown:()=>I});function I(e){return s(\"markdown.parseMarkdown\",e)}var g={};P(g,{deleteAttachment:()=>H,deletePage:()=>D,getAttachmentMeta:()=>K,getPageMeta:()=>q,listAttachments:()=>V,listPages:()=>j,listPlugs:()=>_,readAttachment:()=>z,readPage:()=>Q,writeAttachment:()=>G,writePage:()=>U});function j(e=!1){return s(\"space.listPages\",e)}function q(e){return s(\"space.getPageMeta\",e)}function Q(e){return s(\"space.readPage\",e)}function U(e,t){return s(\"space.writePage\",e,t)}function D(e){return s(\"space.deletePage\",e)}function _(){return s(\"space.listPlugs\")}function V(){return s(\"space.listAttachments\")}function K(e){return s(\"space.getAttachmentMeta\",e)}function z(e){return s(\"space.readAttachment\",e)}function G(e,t,r){return s(\"space.writeAttachment\",e,t,r)}function H(e){return s(\"space.deleteAttachment\",e)}var y=$(R(\"https://deno.land/std/encoding/yaml.ts\"));async function b(e,t=[\"yaml\"]){let r=await g.readPage(e),o=await m.parseMarkdown(r),n={};return v(o,i=>{if(i.type!==\"FencedCode\")return!1;let a=x(i,\"CodeInfo\");if(!a||!t.includes(a.children[0].text))return!1;let l=x(i,\"CodeText\");if(!l)return!1;let c=l.children[0].text;try{n=y.parse(c)}catch(f){throw console.error(\"YAML Page parser error\",f),new Error(`YAML Error: ${f.message}`)}return!0}),n}async function T(e){try{let t=await b(\"SECRETS\",[\"yaml\",\"secrets\"]),r=[];for(let o of e){let n=t[o];if(n)r.push(n);else throw new Error(`No such secret: ${o}`)}return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e[0]}`):t}}async function W(){try{let[e]=await T([\"githubToken\"]);return e}catch{console.error(\"No github-config page found, using default config\");return}}var u=class{constructor(t){this.token=t}async apiCall(t,r={}){let o=await fetch(t,{...r,headers:{Authorization:this.token?`token ${this.token}`:void 0}});if(o.status!==200)throw new Error(await o.text());return o.json()}listEvents(t){return this.apiCall(`https://api.github.com/users/${t}/events?per_page=100`)}listPulls(t,r=\"all\",o=\"updated\"){return this.apiCall(`https://api.github.com/repos/${t}/pulls?state=${r}&sort=${o}&direction=desc&per_page=100`)}searchIssues(t,r=\"\"){return t=encodeURIComponent(t),this.apiCall(`https://api.github.com/search/issues?q=${t}&sort=${r}&direction=desc&per_page=100`)}listNotifications(){return this.apiCall(\"https://api.github.com/notifications?per_page=100\")}static async fromConfig(){return new u(await W())}};async function k({query:e}){let t=await u.fromConfig(),r=e.filter.find(i=>i.prop===\"repo\");if(!r)throw Error(\"No 'repo' specified, this is mandatory\");e.filter.splice(e.filter.indexOf(r),1);let o=[];if(r.op===\"=\")o=[r.value];else if(r.op===\"in\")o=r.value;else throw new Error(`Unsupported operator ${r.op}`);let n=[];for(let i of await Promise.all(o.map(a=>t.listPulls(a,\"all\",\"updated\"))))n.push(...i);return n=w(e,n.map(i=>A(i))),n}function A(e,t=\"\"){let r={};for(let[o,n]of Object.entries(e))t&&(o=t+\"_\"+o),n&&typeof n==\"object\"?r={...r,...A(n,o)}:r[o]=n;return r}var X=k;return O(Z);})();\n return mod;})()"
    },
    "queryNotifications": {
      "events": [
        "query:gh-notification"
      ],
      "code": "(() => { var mod=(()=>{var C=Object.create;var p=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty;var R=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(r,t)=>(typeof require!=\"undefined\"?require:r)[t]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var P=(e,r)=>{for(var t in r)p(e,t,{get:r[t],enumerable:!0})},h=(e,r,t,o)=>{if(r&&typeof r==\"object\"||typeof r==\"function\")for(let n of M(r))!S.call(e,n)&&n!==t&&p(e,n,{get:()=>r[n],enumerable:!(o=E(r,n))||o.enumerable});return e};var $=(e,r,t)=>(t=e!=null?C(N(e)):{},h(r||!e||!e.__esModule?p(t,\"default\",{value:e,enumerable:!0}):t,e)),O=e=>h(p({},\"__esModule\",{value:!0}),e);var Z={};P(Z,{default:()=>X});function d(e,r){if(r(e))return[e];let t=[];if(e.children)for(let o of e.children)t=[...t,...d(o,r)];return t}function x(e,r){return d(e,t=>t.type===r)[0]}function v(e,r){d(e,r)}function w(e,r){let t=[];if(e.filter.length===0)t=r.slice();else{e:for(let o of r){let n=o;for(let{op:l,prop:a,value:s}of e.filter)switch(l){case\"=\":{let c=n[a];if(Array.isArray(c)&&!Array.isArray(s)){if(!c.includes(s))continue e}else if(Array.isArray(c)&&Array.isArray(s)){if(!c.some(f=>s.includes(f)))continue e}else if(c!=s)continue e;break}case\"!=\":if(n[a]==s)continue e;break;case\"<\":if(!(n[a]<s))continue e;break;case\"<=\":if(!(n[a]<=s))continue e;break;case\">\":if(!(n[a]>s))continue e;break;case\">=\":if(!(n[a]>=s))continue e;break;case\"=~\":if(!new RegExp(s).exec(n[a]))continue e;break;case\"!=~\":if(new RegExp(s).exec(n[a]))continue e;break;case\"in\":if(!s.includes(n[a]))continue e;break}t.push(n)}}return e.orderBy&&(t=t.sort((o,n)=>{let l=e.orderBy,a=e.orderDesc;return o[l]===n[l]?0:o[l]<n[l]?a?1:-1:a?-1:1})),e.limit&&(t=t.slice(0,e.limit)),e.select&&(t=t.map(o=>{let n={};for(let l of e.select)n[l]=o[l];return n})),t}typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var i=self.syscall;var m={};P(m,{parseMarkdown:()=>I});function I(e){return i(\"markdown.parseMarkdown\",e)}var g={};P(g,{deleteAttachment:()=>H,deletePage:()=>D,getAttachmentMeta:()=>K,getPageMeta:()=>q,listAttachments:()=>V,listPages:()=>j,listPlugs:()=>_,readAttachment:()=>z,readPage:()=>Q,writeAttachment:()=>G,writePage:()=>U});function j(e=!1){return i(\"space.listPages\",e)}function q(e){return i(\"space.getPageMeta\",e)}function Q(e){return i(\"space.readPage\",e)}function U(e,r){return i(\"space.writePage\",e,r)}function D(e){return i(\"space.deletePage\",e)}function _(){return i(\"space.listPlugs\")}function V(){return i(\"space.listAttachments\")}function K(e){return i(\"space.getAttachmentMeta\",e)}function z(e){return i(\"space.readAttachment\",e)}function G(e,r,t){return i(\"space.writeAttachment\",e,r,t)}function H(e){return i(\"space.deleteAttachment\",e)}var y=$(R(\"https://deno.land/std/encoding/yaml.ts\"));async function b(e,r=[\"yaml\"]){let t=await g.readPage(e),o=await m.parseMarkdown(t),n={};return v(o,l=>{if(l.type!==\"FencedCode\")return!1;let a=x(l,\"CodeInfo\");if(!a||!r.includes(a.children[0].text))return!1;let s=x(l,\"CodeText\");if(!s)return!1;let c=s.children[0].text;try{n=y.parse(c)}catch(f){throw console.error(\"YAML Page parser error\",f),new Error(`YAML Error: ${f.message}`)}return!0}),n}async function T(e){try{let r=await b(\"SECRETS\",[\"yaml\",\"secrets\"]),t=[];for(let o of e){let n=r[o];if(n)t.push(n);else throw new Error(`No such secret: ${o}`)}return t}catch(r){throw r.message===\"Page not found\"?new Error(`No such secret: ${e[0]}`):r}}async function W(){try{let[e]=await T([\"githubToken\"]);return e}catch{console.error(\"No github-config page found, using default config\");return}}var u=class{constructor(r){this.token=r}async apiCall(r,t={}){let o=await fetch(r,{...t,headers:{Authorization:this.token?`token ${this.token}`:void 0}});if(o.status!==200)throw new Error(await o.text());return o.json()}listEvents(r){return this.apiCall(`https://api.github.com/users/${r}/events?per_page=100`)}listPulls(r,t=\"all\",o=\"updated\"){return this.apiCall(`https://api.github.com/repos/${r}/pulls?state=${t}&sort=${o}&direction=desc&per_page=100`)}searchIssues(r,t=\"\"){return r=encodeURIComponent(r),this.apiCall(`https://api.github.com/search/issues?q=${r}&sort=${t}&direction=desc&per_page=100`)}listNotifications(){return this.apiCall(\"https://api.github.com/notifications?per_page=100\")}static async fromConfig(){return new u(await W())}};async function k({query:e}){let t=await(await u.fromConfig()).listNotifications();return t=w(e,t.map(o=>A(o))),t}function A(e,r=\"\"){let t={};for(let[o,n]of Object.entries(e))r&&(o=r+\"_\"+o),n&&typeof n==\"object\"?t={...t,...A(n,o)}:t[o]=n;return t}var X=k;return O(Z);})();\n return mod;})()"
    },
    "querySearchIssues": {
      "events": [
        "query:gh-search-issue"
      ],
      "code": "(() => { var mod=(()=>{var C=Object.create;var p=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty;var R=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(r,t)=>(typeof require!=\"undefined\"?require:r)[t]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var P=(e,r)=>{for(var t in r)p(e,t,{get:r[t],enumerable:!0})},h=(e,r,t,o)=>{if(r&&typeof r==\"object\"||typeof r==\"function\")for(let n of M(r))!S.call(e,n)&&n!==t&&p(e,n,{get:()=>r[n],enumerable:!(o=E(r,n))||o.enumerable});return e};var $=(e,r,t)=>(t=e!=null?C(N(e)):{},h(r||!e||!e.__esModule?p(t,\"default\",{value:e,enumerable:!0}):t,e)),O=e=>h(p({},\"__esModule\",{value:!0}),e);var Z={};P(Z,{default:()=>X});function d(e,r){if(r(e))return[e];let t=[];if(e.children)for(let o of e.children)t=[...t,...d(o,r)];return t}function x(e,r){return d(e,t=>t.type===r)[0]}function v(e,r){d(e,r)}function w(e,r){let t=[];if(e.filter.length===0)t=r.slice();else{e:for(let o of r){let n=o;for(let{op:l,prop:i,value:a}of e.filter)switch(l){case\"=\":{let c=n[i];if(Array.isArray(c)&&!Array.isArray(a)){if(!c.includes(a))continue e}else if(Array.isArray(c)&&Array.isArray(a)){if(!c.some(f=>a.includes(f)))continue e}else if(c!=a)continue e;break}case\"!=\":if(n[i]==a)continue e;break;case\"<\":if(!(n[i]<a))continue e;break;case\"<=\":if(!(n[i]<=a))continue e;break;case\">\":if(!(n[i]>a))continue e;break;case\">=\":if(!(n[i]>=a))continue e;break;case\"=~\":if(!new RegExp(a).exec(n[i]))continue e;break;case\"!=~\":if(new RegExp(a).exec(n[i]))continue e;break;case\"in\":if(!a.includes(n[i]))continue e;break}t.push(n)}}return e.orderBy&&(t=t.sort((o,n)=>{let l=e.orderBy,i=e.orderDesc;return o[l]===n[l]?0:o[l]<n[l]?i?1:-1:i?-1:1})),e.limit&&(t=t.slice(0,e.limit)),e.select&&(t=t.map(o=>{let n={};for(let l of e.select)n[l]=o[l];return n})),t}typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var s=self.syscall;var m={};P(m,{parseMarkdown:()=>B});function B(e){return s(\"markdown.parseMarkdown\",e)}var g={};P(g,{deleteAttachment:()=>H,deletePage:()=>D,getAttachmentMeta:()=>K,getPageMeta:()=>q,listAttachments:()=>V,listPages:()=>j,listPlugs:()=>_,readAttachment:()=>z,readPage:()=>Q,writeAttachment:()=>G,writePage:()=>U});function j(e=!1){return s(\"space.listPages\",e)}function q(e){return s(\"space.getPageMeta\",e)}function Q(e){return s(\"space.readPage\",e)}function U(e,r){return s(\"space.writePage\",e,r)}function D(e){return s(\"space.deletePage\",e)}function _(){return s(\"space.listPlugs\")}function V(){return s(\"space.listAttachments\")}function K(e){return s(\"space.getAttachmentMeta\",e)}function z(e){return s(\"space.readAttachment\",e)}function G(e,r,t){return s(\"space.writeAttachment\",e,r,t)}function H(e){return s(\"space.deleteAttachment\",e)}var y=$(R(\"https://deno.land/std/encoding/yaml.ts\"));async function b(e,r=[\"yaml\"]){let t=await g.readPage(e),o=await m.parseMarkdown(t),n={};return v(o,l=>{if(l.type!==\"FencedCode\")return!1;let i=x(l,\"CodeInfo\");if(!i||!r.includes(i.children[0].text))return!1;let a=x(l,\"CodeText\");if(!a)return!1;let c=a.children[0].text;try{n=y.parse(c)}catch(f){throw console.error(\"YAML Page parser error\",f),new Error(`YAML Error: ${f.message}`)}return!0}),n}async function T(e){try{let r=await b(\"SECRETS\",[\"yaml\",\"secrets\"]),t=[];for(let o of e){let n=r[o];if(n)t.push(n);else throw new Error(`No such secret: ${o}`)}return t}catch(r){throw r.message===\"Page not found\"?new Error(`No such secret: ${e[0]}`):r}}async function W(){try{let[e]=await T([\"githubToken\"]);return e}catch{console.error(\"No github-config page found, using default config\");return}}var u=class{constructor(r){this.token=r}async apiCall(r,t={}){let o=await fetch(r,{...t,headers:{Authorization:this.token?`token ${this.token}`:void 0}});if(o.status!==200)throw new Error(await o.text());return o.json()}listEvents(r){return this.apiCall(`https://api.github.com/users/${r}/events?per_page=100`)}listPulls(r,t=\"all\",o=\"updated\"){return this.apiCall(`https://api.github.com/repos/${r}/pulls?state=${t}&sort=${o}&direction=desc&per_page=100`)}searchIssues(r,t=\"\"){return r=encodeURIComponent(r),this.apiCall(`https://api.github.com/search/issues?q=${r}&sort=${t}&direction=desc&per_page=100`)}listNotifications(){return this.apiCall(\"https://api.github.com/notifications?per_page=100\")}static async fromConfig(){return new u(await W())}};async function k({query:e}){let r=await u.fromConfig(),t=e.filter.find(i=>i.prop===\"query\");if(!t)throw Error(\"No 'query' specified, this is mandatory\");e.filter=e.filter.filter(i=>i.prop!==\"query\");let o=\"\";if(t.op===\"=\")o=t.value;else throw new Error(`Unsupported operator ${t.op}`);let n=await r.searchIssues(o);return w(e,n.items.map(i=>A(i)))}function A(e,r=\"\"){let t={};for(let[o,n]of Object.entries(e))r&&(o=r+\"_\"+o),n&&typeof n==\"object\"?t={...t,...A(n,o)}:t[o]=n;return t}var X=k;return O(Z);})();\n return mod;})()"
    }
  },
  "assets": {}
}