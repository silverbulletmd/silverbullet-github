{
  "name": "github",
  "functions": {
    "queryEvents": {
      "events": [
        "query:gh-event"
      ],
      "code": "(() => { var mod=(()=>{var A=Object.create;var u=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var $=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var d=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var R=(e,t)=>{for(var r in t)u(e,r,{get:t[r],enumerable:!0})},h=(e,t,r,i)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let n of C(t))!O.call(e,n)&&n!==r&&u(e,n,{get:()=>t[n],enumerable:!(i=M(t,n))||i.enumerable});return e};var m=(e,t,r)=>(r=e!=null?A($(e)):{},h(t||!e||!e.__esModule?u(r,\"default\",{value:e,enumerable:!0}):r,e)),S=e=>h(u({},\"__esModule\",{value:!0}),e);var H={};R(H,{default:()=>I});function y(e,t){if(t(e))return[e];let r=[];if(e.children)for(let i of e.children)r=[...r,...y(i,t)];return r}function g(e,t){return y(e,r=>r.type===t)[0]}function x(e,t){y(e,t)}var j=m(d(\"handlebars\")),L=m(d(\"yaml\"));typeof self>\"u\"&&(self={syscall:(e,...t)=>{throw new Error(\"Not implemented here\")}});var p=self.syscall;async function P(e){return p(\"space.readPage\",e)}function T(e,t){let r=[];if(e.filter.length===0)r=t.slice();else{e:for(let i of t){let n=i;for(let{op:o,prop:s,value:a}of e.filter)switch(o){case\"=\":let l=n[s];if(Array.isArray(l)&&!Array.isArray(a)){if(!l.includes(a))continue e}else if(Array.isArray(l)&&Array.isArray(a)){if(!l.some(f=>a.includes(f)))continue e}else if(l!=a)continue e;break;case\"!=\":if(n[s]==a)continue e;break;case\"<\":if(!(n[s]<a))continue e;break;case\"<=\":if(!(n[s]<=a))continue e;break;case\">\":if(!(n[s]>a))continue e;break;case\">=\":if(!(n[s]>=a))continue e;break;case\"=~\":if(!new RegExp(a).exec(n[s]))continue e;break;case\"!=~\":if(new RegExp(a).exec(n[s]))continue e;break;case\"in\":if(!a.includes(n[s]))continue e;break}r.push(n)}}return e.orderBy&&(r=r.sort((i,n)=>{let o=e.orderBy,s=e.orderDesc;return i[o]===n[o]?0:i[o]<n[o]?s?1:-1:s?-1:1})),e.limit&&(r=r.slice(0,e.limit)),e.select&&(r=r.map(i=>{let n={};for(let o of e.select)n[o]=i[o];return n})),r}async function w(e){return p(\"markdown.parseMarkdown\",e)}var b=m(d(\"yaml\"));async function E(e,t=[\"yaml\"]){let{text:r}=await P(e),i=await w(r),n={};return x(i,o=>{if(o.type!==\"FencedCode\")return!1;let s=g(o,\"CodeInfo\");if(!s||!t.includes(s.children[0].text))return!1;let a=g(o,\"CodeText\");if(!a)return!1;let l=a.children[0].text;try{n=b.default.parse(l)}catch(f){throw console.error(\"YAML Page parser error\",f),new Error(`YAML Error: ${f.message}`)}return!0}),n}async function v(e){try{let t=await E(\"SECRETS\",[\"yaml\",\"secrets\"]),r=[];for(let i of e){let n=t[i];if(n)r.push(n);else throw new Error(`No such secret: ${i}`)}return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e[0]}`):t}}async function D(){try{let[e]=await v([\"githubToken\"]);return e}catch{console.error(\"No github-config page found, using default config\");return}}var c=class{constructor(t){this.token=t}async apiCall(t,r={}){let i=await fetch(t,{...r,headers:{Authorization:this.token?`token ${this.token}`:void 0}});if(i.status!==200)throw new Error(await i.text());return i.json()}async listEvents(t){return this.apiCall(`https://api.github.com/users/${t}/events?per_page=100`)}async listPulls(t,r=\"all\",i=\"updated\"){return this.apiCall(`https://api.github.com/repos/${t}/pulls?state=${r}&sort=${i}&direction=desc&per_page=100`)}async searchIssues(t,r=\"\"){return t=encodeURIComponent(t),this.apiCall(`https://api.github.com/search/issues?q=${t}&sort=${r}&direction=desc&per_page=100`)}async listNotifications(){return this.apiCall(\"https://api.github.com/notifications?per_page=100\")}static async fromConfig(){return new c(await D())}};async function k({query:e}){let t=await c.fromConfig(),r=e.filter.find(o=>o.prop===\"username\");if(!r)throw Error(\"No 'username' filter specified, this is mandatory\");let i=[];if(r.op===\"=\")i=[r.value];else if(r.op===\"in\")i=r.value;else throw new Error(`Unsupported operator ${r.op}`);let n=[];for(let o of await Promise.all(i.map(s=>t.listEvents(s))))n.push(...o);return e.filter.splice(e.filter.indexOf(r),1),T(e,n.map(o=>N(o)))}function N(e,t=\"\"){let r={};for(let[i,n]of Object.entries(e))t&&(i=t+\"_\"+i),n&&typeof n==\"object\"?r={...r,...N(n,i)}:r[i]=n;return r}var I=k;return S(H);})();\n return mod;})()"
    },
    "queryPulls": {
      "events": [
        "query:gh-pull"
      ],
      "code": "(() => { var mod=(()=>{var A=Object.create;var u=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var $=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var d=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var R=(e,t)=>{for(var r in t)u(e,r,{get:t[r],enumerable:!0})},h=(e,t,r,i)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let n of C(t))!O.call(e,n)&&n!==r&&u(e,n,{get:()=>t[n],enumerable:!(i=M(t,n))||i.enumerable});return e};var m=(e,t,r)=>(r=e!=null?A($(e)):{},h(t||!e||!e.__esModule?u(r,\"default\",{value:e,enumerable:!0}):r,e)),S=e=>h(u({},\"__esModule\",{value:!0}),e);var H={};R(H,{default:()=>I});function y(e,t){if(t(e))return[e];let r=[];if(e.children)for(let i of e.children)r=[...r,...y(i,t)];return r}function g(e,t){return y(e,r=>r.type===t)[0]}function x(e,t){y(e,t)}var j=m(d(\"handlebars\")),L=m(d(\"yaml\"));typeof self>\"u\"&&(self={syscall:(e,...t)=>{throw new Error(\"Not implemented here\")}});var p=self.syscall;async function P(e){return p(\"space.readPage\",e)}function T(e,t){let r=[];if(e.filter.length===0)r=t.slice();else{e:for(let i of t){let n=i;for(let{op:o,prop:s,value:a}of e.filter)switch(o){case\"=\":let l=n[s];if(Array.isArray(l)&&!Array.isArray(a)){if(!l.includes(a))continue e}else if(Array.isArray(l)&&Array.isArray(a)){if(!l.some(f=>a.includes(f)))continue e}else if(l!=a)continue e;break;case\"!=\":if(n[s]==a)continue e;break;case\"<\":if(!(n[s]<a))continue e;break;case\"<=\":if(!(n[s]<=a))continue e;break;case\">\":if(!(n[s]>a))continue e;break;case\">=\":if(!(n[s]>=a))continue e;break;case\"=~\":if(!new RegExp(a).exec(n[s]))continue e;break;case\"!=~\":if(new RegExp(a).exec(n[s]))continue e;break;case\"in\":if(!a.includes(n[s]))continue e;break}r.push(n)}}return e.orderBy&&(r=r.sort((i,n)=>{let o=e.orderBy,s=e.orderDesc;return i[o]===n[o]?0:i[o]<n[o]?s?1:-1:s?-1:1})),e.limit&&(r=r.slice(0,e.limit)),e.select&&(r=r.map(i=>{let n={};for(let o of e.select)n[o]=i[o];return n})),r}async function w(e){return p(\"markdown.parseMarkdown\",e)}var b=m(d(\"yaml\"));async function E(e,t=[\"yaml\"]){let{text:r}=await P(e),i=await w(r),n={};return x(i,o=>{if(o.type!==\"FencedCode\")return!1;let s=g(o,\"CodeInfo\");if(!s||!t.includes(s.children[0].text))return!1;let a=g(o,\"CodeText\");if(!a)return!1;let l=a.children[0].text;try{n=b.default.parse(l)}catch(f){throw console.error(\"YAML Page parser error\",f),new Error(`YAML Error: ${f.message}`)}return!0}),n}async function v(e){try{let t=await E(\"SECRETS\",[\"yaml\",\"secrets\"]),r=[];for(let i of e){let n=t[i];if(n)r.push(n);else throw new Error(`No such secret: ${i}`)}return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e[0]}`):t}}async function D(){try{let[e]=await v([\"githubToken\"]);return e}catch{console.error(\"No github-config page found, using default config\");return}}var c=class{constructor(t){this.token=t}async apiCall(t,r={}){let i=await fetch(t,{...r,headers:{Authorization:this.token?`token ${this.token}`:void 0}});if(i.status!==200)throw new Error(await i.text());return i.json()}async listEvents(t){return this.apiCall(`https://api.github.com/users/${t}/events?per_page=100`)}async listPulls(t,r=\"all\",i=\"updated\"){return this.apiCall(`https://api.github.com/repos/${t}/pulls?state=${r}&sort=${i}&direction=desc&per_page=100`)}async searchIssues(t,r=\"\"){return t=encodeURIComponent(t),this.apiCall(`https://api.github.com/search/issues?q=${t}&sort=${r}&direction=desc&per_page=100`)}async listNotifications(){return this.apiCall(\"https://api.github.com/notifications?per_page=100\")}static async fromConfig(){return new c(await D())}};async function k({query:e}){let t=await c.fromConfig(),r=e.filter.find(o=>o.prop===\"repo\");if(!r)throw Error(\"No 'repo' specified, this is mandatory\");e.filter.splice(e.filter.indexOf(r),1);let i=[];if(r.op===\"=\")i=[r.value];else if(r.op===\"in\")i=r.value;else throw new Error(`Unsupported operator ${r.op}`);let n=[];for(let o of await Promise.all(i.map(s=>t.listPulls(s,\"all\",\"updated\"))))n.push(...o);return n=T(e,n.map(o=>N(o))),n}function N(e,t=\"\"){let r={};for(let[i,n]of Object.entries(e))t&&(i=t+\"_\"+i),n&&typeof n==\"object\"?r={...r,...N(n,i)}:r[i]=n;return r}var I=k;return S(H);})();\n return mod;})()"
    },
    "queryNotifications": {
      "events": [
        "query:gh-notification"
      ],
      "code": "(() => { var mod=(()=>{var A=Object.create;var u=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var $=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var d=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(r,t)=>(typeof require!=\"undefined\"?require:r)[t]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var R=(e,r)=>{for(var t in r)u(e,t,{get:r[t],enumerable:!0})},h=(e,r,t,i)=>{if(r&&typeof r==\"object\"||typeof r==\"function\")for(let n of C(r))!O.call(e,n)&&n!==t&&u(e,n,{get:()=>r[n],enumerable:!(i=M(r,n))||i.enumerable});return e};var m=(e,r,t)=>(t=e!=null?A($(e)):{},h(r||!e||!e.__esModule?u(t,\"default\",{value:e,enumerable:!0}):t,e)),S=e=>h(u({},\"__esModule\",{value:!0}),e);var H={};R(H,{default:()=>I});function y(e,r){if(r(e))return[e];let t=[];if(e.children)for(let i of e.children)t=[...t,...y(i,r)];return t}function g(e,r){return y(e,t=>t.type===r)[0]}function x(e,r){y(e,r)}var j=m(d(\"handlebars\")),L=m(d(\"yaml\"));typeof self>\"u\"&&(self={syscall:(e,...r)=>{throw new Error(\"Not implemented here\")}});var p=self.syscall;async function P(e){return p(\"space.readPage\",e)}function T(e,r){let t=[];if(e.filter.length===0)t=r.slice();else{e:for(let i of r){let n=i;for(let{op:a,prop:s,value:o}of e.filter)switch(a){case\"=\":let l=n[s];if(Array.isArray(l)&&!Array.isArray(o)){if(!l.includes(o))continue e}else if(Array.isArray(l)&&Array.isArray(o)){if(!l.some(f=>o.includes(f)))continue e}else if(l!=o)continue e;break;case\"!=\":if(n[s]==o)continue e;break;case\"<\":if(!(n[s]<o))continue e;break;case\"<=\":if(!(n[s]<=o))continue e;break;case\">\":if(!(n[s]>o))continue e;break;case\">=\":if(!(n[s]>=o))continue e;break;case\"=~\":if(!new RegExp(o).exec(n[s]))continue e;break;case\"!=~\":if(new RegExp(o).exec(n[s]))continue e;break;case\"in\":if(!o.includes(n[s]))continue e;break}t.push(n)}}return e.orderBy&&(t=t.sort((i,n)=>{let a=e.orderBy,s=e.orderDesc;return i[a]===n[a]?0:i[a]<n[a]?s?1:-1:s?-1:1})),e.limit&&(t=t.slice(0,e.limit)),e.select&&(t=t.map(i=>{let n={};for(let a of e.select)n[a]=i[a];return n})),t}async function w(e){return p(\"markdown.parseMarkdown\",e)}var b=m(d(\"yaml\"));async function E(e,r=[\"yaml\"]){let{text:t}=await P(e),i=await w(t),n={};return x(i,a=>{if(a.type!==\"FencedCode\")return!1;let s=g(a,\"CodeInfo\");if(!s||!r.includes(s.children[0].text))return!1;let o=g(a,\"CodeText\");if(!o)return!1;let l=o.children[0].text;try{n=b.default.parse(l)}catch(f){throw console.error(\"YAML Page parser error\",f),new Error(`YAML Error: ${f.message}`)}return!0}),n}async function v(e){try{let r=await E(\"SECRETS\",[\"yaml\",\"secrets\"]),t=[];for(let i of e){let n=r[i];if(n)t.push(n);else throw new Error(`No such secret: ${i}`)}return t}catch(r){throw r.message===\"Page not found\"?new Error(`No such secret: ${e[0]}`):r}}async function D(){try{let[e]=await v([\"githubToken\"]);return e}catch{console.error(\"No github-config page found, using default config\");return}}var c=class{constructor(r){this.token=r}async apiCall(r,t={}){let i=await fetch(r,{...t,headers:{Authorization:this.token?`token ${this.token}`:void 0}});if(i.status!==200)throw new Error(await i.text());return i.json()}async listEvents(r){return this.apiCall(`https://api.github.com/users/${r}/events?per_page=100`)}async listPulls(r,t=\"all\",i=\"updated\"){return this.apiCall(`https://api.github.com/repos/${r}/pulls?state=${t}&sort=${i}&direction=desc&per_page=100`)}async searchIssues(r,t=\"\"){return r=encodeURIComponent(r),this.apiCall(`https://api.github.com/search/issues?q=${r}&sort=${t}&direction=desc&per_page=100`)}async listNotifications(){return this.apiCall(\"https://api.github.com/notifications?per_page=100\")}static async fromConfig(){return new c(await D())}};async function k({query:e}){let t=await(await c.fromConfig()).listNotifications();return t=T(e,t.map(i=>N(i))),t}function N(e,r=\"\"){let t={};for(let[i,n]of Object.entries(e))r&&(i=r+\"_\"+i),n&&typeof n==\"object\"?t={...t,...N(n,i)}:t[i]=n;return t}var I=k;return S(H);})();\n return mod;})()"
    },
    "querySearchIssues": {
      "events": [
        "query:gh-search-issue"
      ],
      "code": "(() => { var mod=(()=>{var A=Object.create;var u=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var $=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var d=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(r,t)=>(typeof require!=\"undefined\"?require:r)[t]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var S=(e,r)=>{for(var t in r)u(e,t,{get:r[t],enumerable:!0})},P=(e,r,t,i)=>{if(r&&typeof r==\"object\"||typeof r==\"function\")for(let n of C(r))!O.call(e,n)&&n!==t&&u(e,n,{get:()=>r[n],enumerable:!(i=M(r,n))||i.enumerable});return e};var m=(e,r,t)=>(t=e!=null?A($(e)):{},P(r||!e||!e.__esModule?u(t,\"default\",{value:e,enumerable:!0}):t,e)),R=e=>P(u({},\"__esModule\",{value:!0}),e);var H={};S(H,{default:()=>D});function y(e,r){if(r(e))return[e];let t=[];if(e.children)for(let i of e.children)t=[...t,...y(i,r)];return t}function g(e,r){return y(e,t=>t.type===r)[0]}function x(e,r){y(e,r)}var j=m(d(\"handlebars\")),I=m(d(\"yaml\"));typeof self>\"u\"&&(self={syscall:(e,...r)=>{throw new Error(\"Not implemented here\")}});var p=self.syscall;async function h(e){return p(\"space.readPage\",e)}function T(e,r){let t=[];if(e.filter.length===0)t=r.slice();else{e:for(let i of r){let n=i;for(let{op:a,prop:o,value:s}of e.filter)switch(a){case\"=\":let l=n[o];if(Array.isArray(l)&&!Array.isArray(s)){if(!l.includes(s))continue e}else if(Array.isArray(l)&&Array.isArray(s)){if(!l.some(f=>s.includes(f)))continue e}else if(l!=s)continue e;break;case\"!=\":if(n[o]==s)continue e;break;case\"<\":if(!(n[o]<s))continue e;break;case\"<=\":if(!(n[o]<=s))continue e;break;case\">\":if(!(n[o]>s))continue e;break;case\">=\":if(!(n[o]>=s))continue e;break;case\"=~\":if(!new RegExp(s).exec(n[o]))continue e;break;case\"!=~\":if(new RegExp(s).exec(n[o]))continue e;break;case\"in\":if(!s.includes(n[o]))continue e;break}t.push(n)}}return e.orderBy&&(t=t.sort((i,n)=>{let a=e.orderBy,o=e.orderDesc;return i[a]===n[a]?0:i[a]<n[a]?o?1:-1:o?-1:1})),e.limit&&(t=t.slice(0,e.limit)),e.select&&(t=t.map(i=>{let n={};for(let a of e.select)n[a]=i[a];return n})),t}async function w(e){return p(\"markdown.parseMarkdown\",e)}var b=m(d(\"yaml\"));async function E(e,r=[\"yaml\"]){let{text:t}=await h(e),i=await w(t),n={};return x(i,a=>{if(a.type!==\"FencedCode\")return!1;let o=g(a,\"CodeInfo\");if(!o||!r.includes(o.children[0].text))return!1;let s=g(a,\"CodeText\");if(!s)return!1;let l=s.children[0].text;try{n=b.default.parse(l)}catch(f){throw console.error(\"YAML Page parser error\",f),new Error(`YAML Error: ${f.message}`)}return!0}),n}async function v(e){try{let r=await E(\"SECRETS\",[\"yaml\",\"secrets\"]),t=[];for(let i of e){let n=r[i];if(n)t.push(n);else throw new Error(`No such secret: ${i}`)}return t}catch(r){throw r.message===\"Page not found\"?new Error(`No such secret: ${e[0]}`):r}}async function L(){try{let[e]=await v([\"githubToken\"]);return e}catch{console.error(\"No github-config page found, using default config\");return}}var c=class{constructor(r){this.token=r}async apiCall(r,t={}){let i=await fetch(r,{...t,headers:{Authorization:this.token?`token ${this.token}`:void 0}});if(i.status!==200)throw new Error(await i.text());return i.json()}async listEvents(r){return this.apiCall(`https://api.github.com/users/${r}/events?per_page=100`)}async listPulls(r,t=\"all\",i=\"updated\"){return this.apiCall(`https://api.github.com/repos/${r}/pulls?state=${t}&sort=${i}&direction=desc&per_page=100`)}async searchIssues(r,t=\"\"){return r=encodeURIComponent(r),this.apiCall(`https://api.github.com/search/issues?q=${r}&sort=${t}&direction=desc&per_page=100`)}async listNotifications(){return this.apiCall(\"https://api.github.com/notifications?per_page=100\")}static async fromConfig(){return new c(await L())}};async function k({query:e}){let r=await c.fromConfig(),t=e.filter.find(o=>o.prop===\"query\");if(!t)throw Error(\"No 'query' specified, this is mandatory\");e.filter=e.filter.filter(o=>o.prop!==\"query\");let i=\"\";if(t.op===\"=\")i=t.value;else throw new Error(`Unsupported operator ${t.op}`);let n=await r.searchIssues(i);return T(e,n.items.map(o=>N(o)))}function N(e,r=\"\"){let t={};for(let[i,n]of Object.entries(e))r&&(i=r+\"_\"+i),n&&typeof n==\"object\"?t={...t,...N(n,i)}:t[i]=n;return t}var D=k;return R(H);})();\n return mod;})()"
    }
  }
}